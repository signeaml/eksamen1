---
import Layout from "../Layout.astro";
import CardSkitse from "../components/Card_skitse.astro";
import Filtrering from "../components/Filtrering.astro";
import Filtering from "../components/Filtrering.astro";
import KnapIndlaes from "../components/Knap_indlaes.astro";

const response = await fetch(
  "https://edmdwdbbleydenvducsr.supabase.co/rest/v1/skitse",
  {
    method: "GET",
    headers: {
      apikey:
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVkbWR3ZGJibGV5ZGVudmR1Y3NyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTU2MTk3MDQsImV4cCI6MjAzMTE5NTcwNH0.FuI_0k2FhT6bryNsIK2YrNwfo_XJGqVMm9bbVrtxHrU",
    },
  }
);
const data = await response.json();
//console.log("DATA",data)
---

<Layout>
  <h1>Skitser</h1>

  <div class="grid_1_3">
    <div>
      <Filtrering />
    </div>
    <div class="skitse">
      {
        data.slice(0, 12).map((element) => {
          return (
            <CardSkitse
              kunstner={element.kunstner}
              skitseimg={element.skitseimg}
              maal={element.maal}
              pris={element.pris}
            />
          );
        })
      }
      <KnapIndlaes id="load-more" />
    </div>
  </div>
</Layout>

<style>
  h1 {
    padding-bottom: 40px;
  }
  .skitse {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    justify-items: center;
  }

  .grid_1_3 {
    display: grid;
    grid-template-columns: 1fr 3fr;
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    let loadMoreBtn = document.querySelector("#load-more") as HTMLButtonElement;
    if (loadMoreBtn !== null) {
      let currentItem = 12;

      loadMoreBtn.onclick = () => {
        console.log("Button clicked"); // Tjek om denne besked vises i konsollen

        let boxes = document.querySelectorAll(".skitse > *");

        for (
          let i = currentItem;
          i < currentItem + 12 && i < boxes.length;
          i++
        ) {
          (boxes[i] as HTMLElement).style.display = "inline-block";
        }

        currentItem += 12;

        if (currentItem >= boxes.length) {
          loadMoreBtn.style.display = "none";
        }
      };
    }
  });
</script>
